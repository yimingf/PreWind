<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>wind map</title>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src='https://d3js.org/topojson.v1.min.js'></script>

<style type='text/css'>
  .feature {
    fill: lightblue;
    stroke: grey;
    stroke-width: 1px;
    stroke-linejoin: round;
  }
  .feature:hover {
    fill : #adccff;
  }
  .mesh {
    fill: none;
    stroke: lightpink;
    stroke-width: 2px;
    stroke-linejoin: round;
  }
  h1 {
    font-family: courier;
  }
  .hidden {
    display: none;
  }
  div.tooltip {
    color: #222;
    background-color: #fff;
    padding: .5em;
    text-shadow: #f5f5f5 0 1px 0;
    border-radius: 2px;
    opacity: 0.9;
    position: absolute;
  }
</style>
</head>
<body>
  <h1>european wind map.</h1>

<script type='text/javascript'>

var wind_data = {"type":"wind_data","objects":[{"header":{"discipline":0,"disciplineName":"Meteorological products","gribEdition":2,"gribLength":131858,"center":7,"centerName":"US National Weather Service - NCEP(WMC)","subcenter":0,"refTime":"2014-01-31T00:00:00.000Z","significanceOfRT":1,"significanceOfRTName":"Start of forecast","productStatus":0,"productStatusName":"Operational products","productType":1,"productTypeName":"Forecast products","productDefinitionTemplate":0,"productDefinitionTemplateName":"Analysis/forecast at horizontal level/layer at a point in time","parameterCategory":2,"parameterCategoryName":"Momentum","parameterNumber":2,"parameterNumberName":"U-component_of_wind","parameterUnit":"m.s-1","genProcessType":2,"genProcessTypeName":"Forecast","forecastTime":3,"surface1Type":103,"surface1TypeName":"Specified height level above ground","surface1Value":10,"surface2Type":255,"surface2TypeName":"Missing","surface2Value":0,"gridDefinitionTemplate":0,"gridDefinitionTemplateName":"Latitude_Longitude","numberPoints":65160,"shape":6,"shapeName":"Earth spherical with radius of 6,371,229.0 m","gridUnits":"degrees","resolution":48,"winds":"true","scanMode":0,"nx":360,"ny":181,"basicAngle":0,"subDivisions":0,"lo1":0,"la1":90,"lo2":359,"la2":-90,"dx":1,"dy":1},"data":[-5.11,-2.82,-1.42,-0.69,-0.35,-0.85,-1.83,-2.05,-2.19,-4.28,-5.17,-4.01,-3.84,-4.13,-4.04,-3.55,-3.31,-2.68,-2.42,-2.72,-2.47,-1.86,-0.99,-0.76,-1.21,-1.13,-0.77,-0.53,-0.2,0.39,1.28,2.67,2.75,2.6,2.76,2.96,3.86,5.35,4.06,3.86,3.88,3.22,2.91,3.35,3.45,-0.43,-0.42,-1.69,-1.24,-2.41,-7.24,-12.77,-15.29,-13.67,-11.98,-10.89,-9.38,-8.25,-8.37,-8.47,-8.23,-7.83,-7.65,-8.08,-8.37,-7.36,-5.63,-4.31,-2.95,-2.28,-1.55,-1.58,-2.26,-2.35,-2.26,-1.5,-1.65,-3.17,-2.66,-1.95,-2.56,-3.07,-2.99,-2.79,-2.68,-4.8,-5.8,-4.58,-2.49,-1.76,-1.75,-1.29,-1.12,-0.86,-0.75,-0.2,0.04,0.77,1.72,2.2,2.18,1.97,2.55,3.62,4.09,3.64,3.36,3.57,2.93,2.66,3.28,-4.3,-2.46,-0.27,2.02,4.04,5.25,0.67,-9.09,-14.27,-13.49,-11.35,-9.99,-8.58,-6.86,-5.84,-5.4,-5.3,-4.55,-3.09,-2.84,-4.58,-5.66,-5.21,-3.73,-3.21,-3.11,-2.65,-2.39,-3.17,-2.89,-1.82,-1.09,-1.87,-2.25,-1.97,-2.24,-2.82,-2.73,-2.82,-5.11,-5.91,-6.94,-7.05,-3.91,-2.51,-2.16,-1.86,-1.81,-1.47,-0.88,-0.37,-0.06,0.56,0.94,1.31,1.76,2.24,1.74,2.59,3.13,3.03,3.04,3.36,3.74,2.7,3.24,-8.88,-8.04,-6.61,-4.74,-3.34,-1.95,0.26,-1.31,-7.01,-11.41,-12.8,-11.05,-9.02,-7.95,-6.81,-6.27,-5.72,-5.32,-4.87,-4.04,-4.37,-5.53,-6.35,-6.12,-4.96,-4.35,-3.55,-3.19,-2.99,-2.85,-1.15,-1.37,-1.87,-1.88,-2,-2.48,-2.46,-2.73,-2.87,-4.92,-5.47,-5.81,-6.93,-4.58,-3.7,-2.78,-2.33,-2.14,-1.81,-1.32,-0.84,0.93,2.98,1.8,0.07,1.42,2.22,2.1,2.12,2.98,2.45,2.82,3.15,3.22,2.74,3.06,-13.03,-12.3,-11.43,-9.95,-8.7,-8.37,-6.95,-3.9,-1.46,-3.25,-7.44,-9.56,-8.66,-7.08,-6.2,-6.28,-6.13,-5.34,-5.59,-6.13,-5.57,-6.43,-7.51,-9.21,-9.16,-7.18,-4.09,-3.68,-3.67,-1.84,-1.09,-0.59,-1.62,-3,-3.03,-3.45,-3.67,-3.56,-2.8,-2.28,-4.37,-4.73,-4.98,-6.55,-6.35,-3.94,-2.44,-2.11,-2.28,-1.68,-1.26,-0.68,0.07,0.27,0.27,0.85,2.28,2.85,2.58,2.74,2.41,2.6,2.85,2.9,2.78,2.65,-16.4,-14.51,-12.9,-11.41,-9.22,-6.47,-4.42,-3.52,-1.88,-1.04,-4.55,-7.32,-6.7,-6.03,-5.12,-4.76,-5.11,-4.65,-5.2,-6.99,-6.97,-8.29,-8.36,-9.12,-11.08,-12.38,-9.83,-6.62,-3.99,-1.69,-2.39,-4.55,-3.92,-2.26,-3.77,-4.31,-3.38,-3.63,-3.55,-3.53,-4.02,-3.94,-3.93,-4.38,-5.65,-4.52,-3.56,-2.9,-2.26,-2.1,-1.96,-1.29,-0.54,-0.11,0.35,1.4,2.24,2.48,2.79,2.68,2.76,2.81,2.61,2.48,2.82,2.45,-21.25,-19.06,-15.83,-12.8,-10.14,-7.44,-5.02,-3.36,-1.89,-0.2,-2.12,-6.26,-6.23,-5.41,-4.95,-4.57,-5.18,-4.86,-4.83,-6.31,-7.75,-7.43,-8.54,-9.11,-9.32,-9.92,-11.73,-12.65,-9.66,-8.05,-9,-8.26,-7.29,-3.64,-2.86,-2.48,-2.57,-2.54,-4.75,-5.52,-5.61,-5.83,-5.43,-4.19,-4.25,-5.7,-3.79,-3.01,-2.68,-3.27,-1.94,-1.57,-0.98,-0.81,0.17,1.38,1.65,2.28,2.49,3.03,3.06,3.44,2.81,2.9,2.68,2.35,-21.15,-19.73,-17.89,-16.24,-13.65,-10.01,-6.57,-4.28,-2.68,-0.43,-0.31,-5.01,-6.46,-5.39,-5.03,-4.97,-4.13,-3.27,-5.67,-5.78,-6.21,-7.71,-8.45,-9.11,-9.81,-9.98,-10.03,-9.93,-9.21,-8.19,-6.32,-4.27,-8.5,-7.25,-4.32,-3.42,-3.19,-2.67,-5.17,-6.96,-7.17,-7,-6.44,-4.07,-4.21,-4.94,-4.69,-3.73,-3.25,-2.43,-2.47,-1.65,-1.52,-0.89,0.19,1.32,1.87,2.21,2.88,2.77,3.49,3.25,3.72,3.32,3,2.82,2.5,-5.11,-12.92,-14.67,-13.72,-12.68,-9.82,-6.39,-4.62,-2.25,0.45,-2.34,-6.05,-5.79,-7.29,-6.25,-2.93,-3.26,-2.99,-5.1,-7.56,-8.1,-9.48,-10.14,-10.27,-10.08,-9.7,-9.59,-9.35,-7.68,-4.7,-5.44,-7.76,-6.98,-4.71,-3.98,-6.48,-6.52,-6.27,-7.26,-8.06,-8.27,-7.79,-4.24,-4.45,-4.23,-4.04,-4.04,-4.69,-3.89,-3.34,-2.51,-2.46,-1.43,-0.49,0.81,1.2,1.85,2.62,2.9,2.7,2.68,2.8,2.98,2.92,3.36,9.19,9.75,8.73,-0.56,-10.01,-11.52,-10.27,-8.63,-6.01,-3.52,-0.35,-0.88,-4.18,-5.17,-5.9,-6.46,-4.7,-3.14,-3.22,-4.76,-6.42,-5.98,-6.51,-7.97,-8.88,-9.07,-8.69,-8.6,-8.81,-9.34,-5.95,-7.35,-7.3,-6.25,-9.6,-8.74,-8.14,-7.49,-6.47,-6.79,-7.68,-7.88,-6.87,-4.87,-5.51,-4.91,-4.89,-4.4,-3.77,-3.93,-3.34,-3.07,-2.78,-2.28,-1.25,-0.42,0.23,0.98,1.73,2.47,2.58,2.43,2.34,2.42,2.65,2.99,16.06,14.85,13.56,13.1,8.27,-2.1,-8.54,-8.05,-6.27,-3.55,-0.49,-0.29,-3.8,-3.93,-3.43,-3.39,-4.67,-3.76,-3.03,-2.95,-5.31,-5.36,-6.12,-6.54,-6.55,-6.54,-6.64,-7.51,-8.24,-8.78,-6.9,-6.1,-6.67,-6.46,-5.73,-7.6,-5.46,-4.45,-5.55,-6.31,-3.61,-4.66,-5.04,-5.31,-4.81,-4.72,-5.2,-4.83,-4.6,-3.83,-3.64,-3.17,-3.01,-2.47,-2.04,-1.53,-0.88,-0.33,0.58,1.74,2.3,2.29,2.2,2.25,2.55,3.2,3.35,18.32,17.67,16.84,15.1,12.71,3.7,-4.01,-4.95,-3.37,-0.03,-0.02,-2.88,-3.37,-3.87,-2.11,-1.39,-3.42,-3.33,-2.84,-3.11,-2.62,-3.28,-3.49,-3.89,-4.21,-4.04,-3.16,-3.63,-4.42,-5.63,-6.53,-5.9,-5.79,-5.79,-5.55,-6.01,-6.31,-6.6,-7.01,-7.17,-7.45,-5.76,-5.4,-4.97,-4.84,-4.83,-5.01,-4.75,-4.37,-4.04,-3.73,-3.56,-3.28,-3,-2.41,-2.02,-1.46,-1.12,-0.08,0.69,1.33,1.65,1.82,2.25,2.61,2.63,20.32,19.71,18.75,17.69,14.64,9.87,3.4,-0.05,-2.24,-0.62,1.11,-0.72,-2.2,-3.73,-1.79,-1.62,-0.77,-0.16,-0.73,-1.87,-0.04,-0.6,-0.87,-0.55,-1.2,-1.51,-1.75,-1.15,-1.56,-2.13,-1.9,-2.42,-3.82,-4.87,-5.94,-6.22,-5.17,-5.39,-6.11,-7.12,-7.54,-6.81,-6.62,-6.31,-5.53,-5.26,-5.06,-4.71,-4.54,-4.41,-3.91,-4.17,-4.4,-3.89,-3.42,-2.84,-2.76,-2,-1.84,-0.9,-0.47,0.32,0.89,1.27,1.75,2.03,21.18,20.44,18.71,15.57,11.85,10.47,6.14,4.01,0.66,-0.98,-0.35,-0.28,1.08,-0.46,-1.18,-1.86,-1.4,0.43,0.72,0.63,-0.31,-0.82,-1.31,-1,0,1.1,0.35,-0.32,-0.45,-0.72,-1.22,-0.8,-0.08,-0.86,-1.93,-2.73,-3,-4.61,-5.23,-5.94,-8.28,-5.87,-5.58,-5.61,-5.57,-5.77,-5.81,-5.21,-4.6,-4.55,-4.37,-4.45,-4.99,-4.24,-3.52,-3.3,-3.37,-3.35,-2.86,-2.4,-1.82,-1.44,-0.43,0.05,0.6,0.85,20.51,18.59,16.41,14.05,12.43,11.71,7.77,5.4,3.29,0.26,1.68,4.14,3.75,0.53,-0.33,-1.3,-1.62,-1.54,-1.3,-0.92,-0.15,-1.72,-1.2,-1.12,-1.24,-0.29,0.44,0.23,-0.61,-1.72,-1.3,-1.52,-2.04,-2.37,-2.82,-3.09,-6.96,-2.83,-0.19,-3.75,-4.54,-4.84,-4.34,-6.73,-5.94,-6.18,-6.17,-4.66,-4.13,-3.92,-4.45,-5.16,-5.06,-4.9,-4.91,-4.51,-4.54,-5.05,-4.69,-4.3,-3.36,-2.92,-2.17,-1.45,-0.76,-0.16,16.44,15.78,14.98,13.89,12.24,12.44,10.46,5.57,4.73,2.25,2.72,4.47,5.22,2.11,-0.04,-1.13,-2.3,-1.61,0.34,1.42,0.31,0.19,-0.07,0.1,-0.27,-1.89,-0.86,-1.26,-0.58,-0.43,-0.9,-1.12,-1.38,-2.39,-2.2,-7.48,-6.87,-4.55,-2.93,-3.11,-1.27,-0.37,-0.97,-1.78,-3.58,-8.18,-6.54,-5.63,-4.47,-4.47,-5.13,-5.99,-6.12,-6.87,-5.46,-5.87,-6.64,-6.08,-5.92,-5.17,-5.18,-4.67,-4.19,-3.59,-2.75,-2.11,14.75,13.9,13.59,13.02,12.49,11.99,10.61,7.05,6.49,4.47,4.16,5.48,6.11,4.02,0.49,-0.51,-0.04,1.37,1.18,0.24,-0.92,-0.24,0.32,0.2,0.33,-0.47,-0.9,-0.23,0.18,1.08,0.76,1.02,-0.41,-1.8,-2.5,-2.29,-2.91,-5.62,-5.5,-4.27,-2.69,-2.18,-4.09,-3.54,-3.57,-1.82,-3.94,-4.89,-4.14,-4.3,-4.45,-6.21,-7.15,-6.41,-6.35,-6.21,-6.93,-7.45,-7.52,-6.59,-6.48,-5.66,-5.69,-6.36,-4.64,-2.9,13.34,13.29,13.14,12.83,12.7,11.85,10.23,8.18,6.73,5.66,5.56,6.27,6.57,6.01,3.04,-1.48,-2.01,-0.83,0.2,0.04,0.47,-0.21,0.17,0.45,0.25,-0.15,-1.19,-0.4,-0.32,-0.34,-1.26,-0.88,-1.28,-2.14,-1.85,-1.2,-2.03,-2.97,-5.25,-5.82,-4.46,-0.46,-0.42,-3.56,-2.6,-4.46,-0.85,-2.22,-1.86,-1.84,-4.59,-6.14,-5.57,-6.57,-7.05,-6.11,-8.42,-11.22,-13.72,-12.53,-8.81,-7.36,-6.92,-6.76,-5.63,-3.56,12.86,13.17,12.94,12.64,12.15,11.23,10.29,9.39,6.28,5.67,6.04,6.36,7.11,7.14,6.11,3.25,-0.75,-1.62,-1.49,0.24,-0.97,-0.95,-0.37,0.57,0.3,-0.09,-1.05,-2.21,-1.14,0.21,-1.71,-2.09,-1.21,-3.32,-3.01,-2.07,-2.19,-4,-4.75,-5.33,-5.13,-3.81,-3.83,-2.76,-0.98,-2.96,-3.75,0,-2,-3.42,-4.22,-9.8,-9.06,-8.06,-10.13,-15.95,-17.72,-18.34,-14.07,-9.78,-10.97,-11.16,-8.88,-7.49,-7.28,-4.79,12.66,12.34,11.79,11.46,11.21,11.13,10.53,10.07,6.52,5.63,5.96,6.26,7.02,7.61,7.49,7.34,3.07,-1.46,-1.81,-2.43,-0.63,-1.33,-1.12,-0.36,0.86,-0.16,-2.6,-0.51,2.73,1.56,2.43,-1.42,-1.67,-8.94,-9.6,-3.86,-2.14,-2.54,-2.35,-4.56,-7.75,-4.92,-5.89,-1.24,-0.65,-2.05,-2.74,-2.98,-2.17,-1.17,-7.65,-9.15,-11.16,-8.76,-4.58,-5.14,-10.83,-12.73,-8.16,-8.77,-11.36,-11.92,-11.06,-7.96,-6.2,-4.85,11.99,11.61,11.07,10.95,11.71,11.99,10.62,10.2,7.33,6.19,6.03,6.6,6.64,7.38,8.33,8.57,9.61,3.64,0.48,-0.13],"meta":{"date":"2014-01-31T03:00:00.000Z"}},{"header":{"discipline":0,"disciplineName":"Meteorological products","gribEdition":2,"gribLength":131858,"center":7,"centerName":"US National Weather Service - NCEP(WMC)","subcenter":0,"refTime":"2014-01-31T00:00:00.000Z","significanceOfRT":1,"significanceOfRTName":"Start of forecast","productStatus":0,"productStatusName":"Operational products","productType":1,"productTypeName":"Forecast products","productDefinitionTemplate":0,"productDefinitionTemplateName":"Analysis/forecast at horizontal level/layer at a point in time","parameterCategory":2,"parameterCategoryName":"Momentum","parameterNumber":3,"parameterNumberName":"V-component_of_wind","parameterUnit":"m.s-1","genProcessType":2,"genProcessTypeName":"Forecast","forecastTime":3,"surface1Type":103,"surface1TypeName":"Specified height level above ground","surface1Value":10,"surface2Type":255,"surface2TypeName":"Missing","surface2Value":0,"gridDefinitionTemplate":0,"gridDefinitionTemplateName":"Latitude_Longitude","numberPoints":65160,"shape":6,"shapeName":"Earth spherical with radius of 6,371,229.0 m","gridUnits":"degrees","resolution":48,"winds":"true","scanMode":0,"nx":360,"ny":181,"basicAngle":0,"subDivisions":0,"lo1":0,"la1":90,"lo2":359,"la2":-90,"dx":1,"dy":1},"data":[11.13,10,9.22,8.73,7.99,7.05,5.71,4.05,4.24,6.89,5.88,2.34,1.14,2.19,3.42,2.5,2.14,2.07,1.89,2.01,2.4,5.11,7.68,7.21,3.81,2.89,3.3,3.54,3.33,3.17,3.31,3.58,2.71,1.9,2.03,2.34,2.15,1.95,1.16,0.58,0.69,0.62,0.9,1.22,1.03,-2.59,-1.47,0.17,-0.49,-0.74,4.03,12.41,15.73,13.98,12.98,12.82,12.5,12.02,11.06,9.61,8.75,8.48,9.36,10.54,11.3,11.68,15.11,13.14,10.92,9.3,7.35,5.01,3.25,2.28,2.67,3.12,3.9,4.42,3.31,3.55,3.53,2.74,2.1,1.79,3.15,8.37,9.09,5.93,3.32,2.95,3.25,3.31,3.56,3.79,3.48,3.02,3.02,2.75,2.5,2.4,2.26,2.3,2.16,1.64,1.45,1.19,0.84,0.92,0.43,0.03,0.13,-2.48,-2.59,-2.24,-1.73,-1.91,-3.49,0.03,10.91,15.83,14.46,13.88,13.73,13.37,12.65,12.39,13.11,12.9,12.33,12.02,12.82,14.72,14.56,13.9,12.69,10.91,7.78,3.86,2.52,3.19,3.73,2.87,2.87,2.84,1.72,1.21,1.3,1.48,1.04,3.02,9.58,10.5,10.32,8.17,3.33,3.28,2.98,3.05,3.79,3.26,3.84,4.47,3.15,3.17,3.27,3.03,2.31,3.02,2.36,1.61,1,0.62,0.87,0.27,-0.02,0.57,0.4,-0.57,-0.88,-1.69,-2.95,-3.48,-5.56,-8.61,-0.97,12,15.73,14.85,14.04,14.19,13.95,13.05,13.75,13.62,13.3,13.12,13.23,14.07,13.52,13.69,13.63,12.1,7.89,1.96,0.6,1.59,0.93,-0.36,-0.41,-0.33,-0.2,0.1,0.3,0.81,1.8,3.51,8.66,10.82,12.09,9.63,2.54,3.25,3.61,3.46,3.89,3.91,4.01,3.21,4.41,8.35,7.98,3.67,2.49,2.24,2.06,0.77,0.53,0.67,0.41,0.04,0.03,-0.28,-0.57,0.08,0.48,0.62,0.15,-1.11,-3.31,-2.87,4,9.95,13.55,17.14,16.46,14.94,14.5,13.89,13.71,13.63,13.28,13.23,13.27,13.22,12.55,12.64,12.72,12.15,9.71,4.06,0.17,-0.09,-0.75,-1.31,-1.66,-0.81,0.02,0.23,1.18,1.89,1.93,1.69,2.82,8.37,11.12,13.01,13.11,10.49,8.66,10.79,12.31,13.11,11.73,7.27,4.98,4.97,4.3,3.02,2.61,1.83,1.45,1.76,1.09,0.56,0.2,-0.14,-0.69,-0.79,-0.94,3.66,5.16,5.97,6.22,6.16,6.73,9.36,11.6,10.48,10.76,15.96,17.76,16.36,15.51,14.03,13.23,13.72,13.42,12.9,12.7,12.18,11.16,10.87,10.56,9.92,8.62,5.46,0.93,-0.91,-1.54,-2.35,-1.31,0.81,1.11,3.45,3.17,1.74,1.97,3.77,7.28,9.99,10.38,12.44,12.55,10.64,4.38,4.31,4.18,4.47,4.52,3.93,3.99,3.91,3.73,3.33,2.48,1.87,1.4,0.76,0.17,-0.03,-0.29,-0.64,-0.87,-1.25,-1.32,6.7,7.94,9.3,10.36,10.74,10.5,10.77,12.47,12.62,10.88,14.37,18.13,17.29,16.65,14.37,11.75,12.33,13.17,12.83,12.26,11.55,10.18,9.27,8.63,8.34,7.77,6.68,4.13,0.87,0.23,1.92,3.23,3.19,1.53,2.22,2.62,2.27,2.75,8.53,8.99,10.39,11.39,11.54,11.44,14.65,13.76,4.44,4.04,4.9,5.43,3.62,3.78,3.79,3.23,3.07,2.59,1.91,1.43,0.86,0.49,-0.17,-1.08,-1.31,-1.62,-1.85,-1.45,11.94,12.36,12.5,12.62,12.67,12.7,12.96,13.77,13.82,11.65,13.11,17.73,17.67,17.41,13.66,9.01,4.29,6.11,11.53,11.28,10.87,8.61,7.98,7.18,6.41,5.78,5.1,4.42,4.23,4.11,2.95,2.37,6.06,3.9,1.55,1.47,1.2,1.83,7.02,9.13,10.78,11.64,8.72,3.15,6.18,7.14,5.11,5.73,4.98,4.59,4.27,4.54,4.29,4.1,3.43,2.67,1.98,1.5,0.85,0.26,-0.44,-1.16,-2.19,-2.33,-2.12,-2.22,14.91,15.41,16.45,16.48,15.7,15.22,15.12,15.32,14.96,13.29,13.17,16.59,17.16,16.34,15.76,6.92,2.29,5.78,5.6,8.8,9.83,7.4,6.51,5.5,4.91,4.43,4.19,3.99,4.01,2.75,0.71,2.16,4.04,2.96,0.78,1.16,4.21,6.27,8.18,9.1,9.84,11.65,9.37,4.25,4.7,4.5,4.59,5.04,5.82,5.54,4.88,5.07,4.56,3.61,3.27,2.6,2.24,1.96,1.05,-0.29,-0.99,-1.17,-1.53,-1.87,-1.84,-1.79,13.54,13.25,12.68,15.08,17.96,17.78,16.72,16.32,15.95,14.9,13.84,15.3,16.25,14.68,14.55,9.94,2.88,2.01,4.78,7.4,7.89,6.21,5.48,5.13,4.61,3.96,3.42,3.54,3.84,3.43,1.21,1.72,1.38,1.65,3.58,3.95,5.27,6.2,6.42,7.3,9.28,8.07,5.84,3.76,5.49,5.38,5.52,4.81,4.66,5.26,4.74,4.17,4.29,4.21,3.67,2.52,2.1,1.8,0.99,-0.09,-1.08,-1.39,-1.55,-1.74,-2.18,-2.33,9.16,10.41,11.07,10.37,11.61,16.92,18.91,17.8,17.16,16.03,14.65,14.29,13.79,5.42,5.01,8.75,8.27,1.58,0.71,2.2,5.85,4.04,4.97,4.44,4.2,3.94,3.66,3.62,3.35,2.68,1.01,0.54,0.85,0.91,1.31,3.17,2.36,2.57,3.89,4.35,2.86,3.71,5.7,6.41,6.15,5.23,5.2,5.07,5.07,4.49,3.81,3.41,3.16,3.09,3.04,2.33,1.79,1.77,1.11,-0.07,-1.2,-1.67,-1.87,-1.84,-1.54,-1.79,5.31,6.86,7.91,9.16,9.86,10.87,16.8,19.66,18.32,17.27,16.3,11.68,5.81,5.73,5.67,7.4,9.35,7.22,3.87,1.57,1.6,4.04,5.29,5.97,4.53,3.49,2.27,0.63,0,-0.17,0.16,0.5,0.07,-0.54,-0.25,0.53,1.27,1.57,1.57,2.45,4.02,4.05,3.56,3.97,4.85,4.85,4.32,4.08,3.69,3.51,3.36,3.05,2.63,2.46,2.42,1.6,1.34,1.22,0.97,0.1,-1.1,-1.87,-2.14,-2.09,-2.33,-2.18,3.82,5.03,5.94,7.32,9.31,11.16,13.72,18.16,19.44,18.2,16.55,13.42,6.11,5.19,4.74,6.84,8.71,2.7,2.57,2.69,2.98,3.11,3.71,6.32,4.24,2.19,0.98,0.94,0.22,0.03,0.46,0.64,0.58,-0.53,-0.13,0.59,0.99,1.3,1.84,1.8,2.97,3.7,4.12,4.31,5.12,4.97,4.25,3.71,3.4,3.1,3.07,2.77,2.55,2.32,2.2,1.56,0.59,0.35,0.19,0.03,-0.9,-1.61,-2.23,-2.64,-3.01,-2.44,3.21,3.83,4.89,6.64,8.87,11.34,12.06,15.31,18.38,17.68,16.53,8.31,4.22,6.72,10.54,9.53,6.13,2.5,2.28,2.77,3.24,1.43,4.43,4.11,2.52,1.02,-0.07,0.94,1.77,0.67,-0.07,0.31,-0.02,0.19,3.22,5.12,5.96,3.67,1.71,2.24,3.23,5.17,3.53,3.58,3.92,3.72,4.66,5.34,5.01,4.52,3.68,2.83,2.02,2.22,1.55,0.89,0.31,-0.14,-0.72,-1.04,-1.23,-1.33,-1.39,-2.17,-2.73,-2.51,2.58,3.45,4.96,6.49,8.94,9.82,9.19,11.91,16.38,16.69,15.27,12.3,7.75,6.25,9.86,9.4,7.21,2.87,1.51,0.44,0.48,5.64,4.43,2.41,2.44,1.79,0.98,0.22,-0.12,-0.38,0.27,0.53,1.09,0.82,-0.73,2.07,5.41,9.12,7.2,4.13,2.29,1.17,0.85,0.53,2.6,4.78,6.03,6.43,4.44,3.54,2.98,1.96,1.44,1,0.6,-0.04,-0.39,-0.67,-1.13,-1.34,-1.74,-1.31,-1.54,-1.9,-2.42,-2.32,3.3,6.14,7.31,7.86,7.88,7.74,7.5,9.98,14,15.18,13.81,11.2,7.32,3.5,6.65,8.28,5.78,3.55,2.11,3.1,5.14,2.69,2.31,1.87,1.74,1.14,0.99,0.19,-0.2,-0.43,0.06,1.61,1.52,0.5,0.58,4.12,6.93,5.85,6.39,3.04,2.47,2.66,2.59,2.2,0.98,3.19,4.8,5.43,4.03,2.85,2.4,1.97,1.14,1,0.68,-0.63,-1.37,-1.97,-1.69,-1.61,-1.24,-1.48,-1.64,-1.69,-1.93,-1.88,6.15,6.11,6.86,6.98,7.14,7.5,8.66,10.44,12.73,14.09,12.2,9.1,5.75,2.08,2.27,6.25,6.33,5.14,4.99,4.92,2.61,1.74,2.04,1.82,0.94,0.29,-0.44,-0.32,1.06,1.08,-0.02,0.1,-0.87,-0.74,1.26,1.71,1.58,4.35,4.65,2.94,0.5,-0.41,-1.75,1.47,1.97,0.18,2.67,3.39,2.42,1.11,0.39,-0.44,-0.59,-1.84,-2.79,-3.11,-3,-2.71,-2.12,-2.24,-3,-2.56,-2.29,-1.92,-1.27,-1.77,6.82,7.22,7.11,6.94,7.38,8.03,8.53,8.67,9.57,11.74,10.34,7.69,4.72,1.47,-1.33,0.85,4.85,2.48,2.55,2.6,1.68,2.14,2.63,1.81,0.42,-0.28,-0.11,0.31,-0.39,0.81,2.61,2.02,2.99,3.06,2.21,1.72,1.25,0.64,1.55,1.49,2.09,2.48,1.35,1.41,4.24,2.36,-0.58,2.1,1.37,-0.15,-1.2,-2.63,-3.07,-3.61,-3.93,-4.72,-5.29,-4.57,-5.04,-4.75,-3.42,-2.8,-1.76,-1.36,-0.85,-1.55,6.21,6.55,6.98,7.51,7.8,7.5,6.94,5.77,5.83,8.98,7.93,5.39,3.03,0.13,-2.59,-3.79,-0.2,5.59,5.51,2.59,1.29,2.3,2.34,1.64,0.55,-1.39,-1.24,-0.68,1.7,-0.17,-2.43,-1.1,-1.6,-3.67,-3.09,-2.13,-1.11,-1.74,0.04,1.05,3.07,5.56,3.77,1.53,0.49,1.95,2.12,0.04,-0.51,-3.03,-5.24,-5.88,-5.11,-6.83,-8.84,-6.85,-5.84,-4.78,-3.84,-4.13,-4.4,-3.28,-2.03,-0.64,0.25,-1.21,7.27,7.5,7.49,7.56,7.09,5.95,4.14,2.76,3.07,6.91,6.16,3.89,1.67,-0.9,-3.07,-4.13,-4.79,0.14,5.07,3.68,2.42,1.54,1.04,0.65,-0.96,-2.56,-2.53,-0.47,-0.33,0.2,0.12,-0.06,-2.1,0.85,15.95,10.46,2.63,0.19,0.69,0.57,2.38,6.26,6.32,3.29,0.83,-0.11,0.16,-0.73,-4.17,-3.48,-6.41,-5.77,-5.84,-7.25,-7.34,-2.03,-6.25,-7.97,-6.44,-2.46,-2.87,-3.03,0.17,2.13,2.52,-0.86,7.25,7.2,7.12,6.74,5.45,2.85,0.88,1.01,1.45,4.79,4.62,2.5,0.44,-1.54,-2.99,-3.93,-4.13,-5.31,-0.3,4.86,2.31],"meta":{"date":"2014-01-31T03:00:00.000Z"}}]};

var width = 1280,
  height = 800;
var projection = d3.geoMercator();
var path = d3.geoPath()
  .projection(projection);

var svg = d3.select('body').append('svg')
  .attr('id', 'foo')
  .attr('width', width)
  .attr('height', height);

d3.json('https://yimingf.github.io/windmind-2017/data/europe.json', function (error, topo) {
  var tooltip = d3.select('body').append('div')
    .attr('class', 'hidden tooltip');

  countries = topojson.feature(topo, topo.objects.europe)
    .features;

  projection
    .scale(500)
    .center([16.09, 50.60]);

  svg.selectAll('path')
    .data(countries).enter()
    .append('path')
    .attr('class', 'feature')
    .attr('d', path);

  var mesh = topojson.mesh(topo, topo.objects.europe, (a, b) => (a != b));

  svg.append('path')
    .datum(mesh)
    .attr('class', 'mesh')
    .attr('fill', 'red')
    .attr('d', path);

  d3.json('https://yimingf.github.io/windmind-2017/data/farms.json', function (error, data) {
    var len = 20;

    svg.selectAll('image')
      .data(data.objects).enter()
      .append('image')
      .attr('href', './lib/assets/img/wind-turbine.png')
      .attr('x', function (d) {
        return (projection(d.location)[0]-len/2);
      })
      .attr('y', function (d) {
        return (projection(d.location)[1]-len);
      })
      .attr('height', len + 'px')
      .attr('width', len + 'px')
      .on('mousemove', function (d) {
        var mouse = d3.mouse(svg.node()).map(function (d) {
          return parseInt(d);
        });
        tooltip.classed('hidden', false)
          .attr('style', 'left:' + (mouse[0] + 15) +
            'px; top:' + (mouse[1] - 35) + 'px')
          .html(function () {
            return 'name: ' + d.name + '<br>location: (' + d.location[0] + ', ' + d.location[1] + ')<br>owner: ' + d.owner + '<br>peak performance: ' + d.peak_production;
          });
      })
      .on('mouseout', function () {
        tooltip.classed('hidden', true);
      })
      .on('click', function () {
        console.log('caonima');
      });
  });

  let lo = (_, i) => i%66;
  let la = (_, i) => Math.floor(i/66);

  let index_to_longitude = d3.scaleLinear() // european fit
    .domain([0, 65])
    .range([-35, 53]);

  let index_to_latitude = d3.scaleLinear()
    .domain([0, 19])
    .range([70, 35]);

  var c = wind_data.objects[0].data
    .map((_, i) => [_, wind_data.objects[1].data[i]]);
  var position = [
    wind_data.objects[0].data
      .map(lo)
      .map(index_to_longitude),
    wind_data.objects[1].data
      .map(la)
      .map(index_to_latitude)
    ];//, wind_data.objects[1].data.map(index_to_latitude(la))];

  position = position[0].map((_, i) => [_, position[1][i]]);
  position = position.map((_, __) => projection(_));
  console.log(position);
  new_positiion = c.map((_, __) => [
    _[0]+position[__][0],
    _[1]+position[__][1]
  ]);
  console.log(new_positiion);

  var lines = svg.selectAll('line')
    .data(c).enter()
    .append('line');
  d3.interval(function() {
    lines.call(function animate(selection) {
      selection
        .attr('x1', (_, i) => position[i][0])
        .attr('x2', (_, i) => position[i][0])
        .attr('y1', (_, i) => position[i][1])
        .attr('y2', (_, i) => position[i][1])
        .style('opacity', 0.5)
        .style('stroke', 'red')
        .transition()
          .ease(d3.easeLinear)
          //.easeLinear()
          .duration(1000)
          .attr('x2', (_, i) => new_positiion[i][0])
          .attr('y2', (_, i) => new_positiion[i][1])
        .transition()
          .ease(d3.easeLinear)
          //.easeLinear()
          .duration(1000)
          .attr('x1', (_, i) => new_positiion[i][0])
          .attr('y1', (_, i) => new_positiion[i][1])
        // .on('end', function() { // don't use 'each'
        //   d3.selectAll('line').call(animate);
        // })
    });
  }, 2200);

});

</script>
    
</body>
</html>